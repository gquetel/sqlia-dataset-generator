# SuperviZ25-SQL Generator 

This repository contains the code used to generate the SuperviZ25-SQL Dataset. This dataset is made to evaluate unsupervized SQL Injection detection techniques. Queries are built using query-templates derived in which normal values are inserted to construct normal samples. Attack samples are generated by the emulation of web application endpoints, on which [sqlmap](https://github.com/sqlmapproject/sqlmap/tree/1.8.7) attack campaigns are launched. 


## Dataset Design Choices

## Generating the dataset locally

### Environment
We provide an environment to generate a similar dataset (there is randomness in the generation of attacks) through the declaration of a shell environment in `shell.nix`. The environment contains: a MySQL server to validate normal queries to and execute attack ones (sqlmap requires interaction with a running DBMS to generate payloads), sqlmap and `percona-toolkit` from which the `pt-kill` command is used to make sure no lock on tables is present before the invocation of `sqlmap`.

The MySQL server (version 8.4) must be initialized using [init_db.sql](data/init_db.sql): unprivileged users from which queries are executed must be created, as well as the databases and tables to prevent errors on executing normal queries. SQLmap invocations should also be realistic and because non existent tables would lead to errors, even when the query is syntactically valid, sqlmap would never be able to finalize its attacks because errors would be thrown.
